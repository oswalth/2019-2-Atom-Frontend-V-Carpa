(this.webpackJsonpfullstack_2019_1=this.webpackJsonpfullstack_2019_1||[]).push([[0],[,function(e,a,t){e.exports={dialogue:"DialogueItem_dialogue__2rBXY",avatar:"DialogueItem_avatar__9XARq",wrapper:"DialogueItem_wrapper__3lnRQ",text:"DialogueItem_text__1WkGt",name:"DialogueItem_name__1rMup",time:"DialogueItem_time__31wNC",info:"DialogueItem_info__WVGza",message:"DialogueItem_message__3mEch",status:"DialogueItem_status__1zUFk"}},function(e,a,t){e.exports={header:"ChatHeader_header__wtf1f",backButton:"ChatHeader_backButton__2kZvs",chatInfo:"ChatHeader_chatInfo__1Q3tD",avatar:"ChatHeader_avatar__W2O5Y",senderInfo:"ChatHeader_senderInfo__1gAM0",searchButton:"ChatHeader_searchButton__30ZIJ",settingsButton:"ChatHeader_settingsButton__SLkJ7"}},function(e,a,t){e.exports={header:"DialoguesHeader_header__1SGyL",menuBurger:"DialoguesHeader_menuBurger__icB5p",messenger:"DialoguesHeader_messenger__36R73",searchButton:"DialoguesHeader_searchButton__1bBEn"}},function(e,a,t){e.exports={messageForm:"MessageForm_messageForm__8PdEl",messagesList:"MessageForm_messagesList__2eLXd",header:"MessageForm_header__10-FU",chat:"MessageForm_chat__31JWU",inputForm:"MessageForm_inputForm__Q4V5O"}},function(e,a,t){e.exports={messageWrap:"MessageItem_messageWrap__udvmP",messageItem:"MessageItem_messageItem__3ZnNZ",message:"MessageItem_message__1157w",timestamp:"MessageItem_timestamp__30gC_"}},function(e,a,t){e.exports={dialogues:"DialogueForm_dialogues__1D1Xl",dialoguesList:"DialogueForm_dialoguesList__2D8k9",empty:"DialogueForm_empty__ygZ6X"}},function(e,a,t){e.exports={formInput:"FormInput_formInput__1CDjc",attachButton:"FormInput_attachButton__2ixoS",sendButton:"FormInput_sendButton__22Gjc"}},function(e,a,t){e.exports={container:"MainForm_container__1Ac2B",chatDisappear:"MainForm_chatDisappear__2crCV",chatAppearance:"MainForm_chatAppearance__2FfsV"}},,,,,,function(e,a,t){e.exports={createDialogueButton:"CreateDialogueButton_createDialogueButton__i92_8"}},,,function(e,a,t){e.exports=t(23)},,,,,function(e,a,t){},function(e,a,t){"use strict";t.r(a);var s=t(0),n=t.n(s),r=t(10);t(22),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=t(11),l=t(12),o=t(15),i=t(13),m=t(16),u=t(6),g=t.n(u),_=t(3),d=t.n(_);function h(){return n.a.createElement("div",{className:d.a.header},n.a.createElement("div",{className:d.a.menuBurger}),n.a.createElement("div",{className:d.a.messenger},"Messenger"),n.a.createElement("div",{className:d.a.searchButton}))}var v=t(1),p=t.n(v),f=n.a.createContext(null);function E(e){var a=e.chat,t=new Date(a.lastMessage.time);return n.a.createElement(f.Consumer,null,(function(e){return n.a.createElement("div",{onClick:e.openDialogue.bind(e,a.id),className:p.a.dialogue},n.a.createElement("div",{className:p.a.avatar}),n.a.createElement("div",{className:p.a.wrapper},n.a.createElement("div",{className:p.a.text},n.a.createElement("div",{className:p.a.name},a.title),n.a.createElement("div",{className:p.a.time},t.toLocaleString("ru",{hour:"numeric",minute:"numeric"}))),n.a.createElement("div",{className:p.a.info},n.a.createElement("div",{className:p.a.message},a.lastMessage.content),n.a.createElement("div",{className:p.a.status},a.lastMessage.status))))}))}var N=t(14),D=t.n(N);function I(e){var a=e.createHandler;return n.a.createElement("button",{onClick:a,className:D.a.createDialogueButton})}function B(e){var a=e.chats,t=[];return 0===a.length?t=n.a.createElement("div",{className:g.a.empty},"No messages yet"):a.forEach((function(e){var a=n.a.createElement(E,{chat:e});t.push(a)})),n.a.createElement("div",{className:g.a.dialogues},n.a.createElement(h,null),n.a.createElement("div",{className:g.a.dialogueList},t),n.a.createElement(f.Consumer,null,(function(e){return n.a.createElement(I,{createHandler:e.createHandler.bind(e)})})))}var C=t(4),k=t.n(C),F=t(2),M=t.n(F);function S(e){var a=e.details,t=e.clickBack;return n.a.createElement("div",{className:M.a.header},n.a.createElement("div",{onClick:t,className:M.a.backButton}),n.a.createElement("div",{className:M.a.chatInfo},n.a.createElement("div",{className:M.a.avatar}),n.a.createElement("div",{className:M.a.senderInfo},n.a.createElement("div",null,a.title),n.a.createElement("div",null,"last seen at 12:00"))),n.a.createElement("div",{className:M.a.searchButton}),n.a.createElement("div",{className:M.a.settingsButton}))}var y=t(7),H=t.n(y);function b(e){var a=n.a.useRef(null),t=e.messageHandler,s=function(){var e=a.current.value.trim();""!==e&&(a.current.value="",t(e))};return n.a.createElement("div",{className:H.a.formInput},n.a.createElement("div",{className:H.a.attachButton}),n.a.createElement("input",{onKeyPress:function(e){13===e.charCode&&s()},ref:a,placeholder:"Enter message..."}),n.a.createElement("button",{onClick:s,className:H.a.sendButton}))}var w=t(5),x=t.n(w);function O(e){var a=e.inner,t=a.content,s=a.time,r=new Date(s);return n.a.createElement("div",{className:x.a.messageWrap},n.a.createElement("div",{className:x.a.messageItem},n.a.createElement("div",{className:x.a.message},t),n.a.createElement("div",{className:x.a.timestamp},r.toLocaleString("ru",{hour:"numeric",minute:"numeric"}))))}function L(e){var a=e.messages,t=e.details,s=e.style;if(null===t)return"";var r=[];return a.forEach((function(e){var a=n.a.createElement(O,{inner:e});r.push(a)})),n.a.createElement("div",{style:s,className:k.a.messageForm},n.a.createElement(f.Consumer,null,(function(e){return n.a.createElement(S,{details:t,clickBack:e.closeDialogue.bind(e)})})),n.a.createElement("div",{className:k.a.chat},n.a.createElement("div",{className:k.a.messagesList},r)),n.a.createElement("div",{className:k.a.inputForm},n.a.createElement(f.Consumer,null,(function(e){return n.a.createElement(b,{messageHandler:e.messageHandler.bind(e)})}))))}var A=t(8),J=t.n(A),W=function(e){function a(e){var t;Object(c.a)(this,a);var s=(t=Object(o.a)(this,Object(i.a)(a).call(this,e))).parseStorage();return t.state={chats:s.chats,messages:s.messages,chatCounter:s.chatCounter,currentDialogue:null,MessageFormAppearance:null,frameStyles:{MessageFormAppearance:null,DialoguesFormAppearance:null}},t}return Object(m.a)(a,e),Object(l.a)(a,[{key:"parseStorage",value:function(){var e={chats:JSON.parse(localStorage.getItem("chats")),messages:JSON.parse(localStorage.getItem("messages")),chatCounter:JSON.parse(localStorage.getItem("chatCounter"))};return e.chats||(e.chats=[],e.messages={},e.chatCounter=0),e}},{key:"openDialogue",value:function(e){var a=this.state;a.MessageFormAppearance={animationName:J.a.chatAppearance},a.currentDialogue=e,this.setState(a)}},{key:"closeDialogue",value:function(){var e=this.state;e.MessageFormAppearance={animationName:J.a.chatDisappear},this.setState(e)}},{key:"messageHandler",value:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=this.state,n=s.currentDialogue,r=s.messages;r||(r={}),t&&(r[(n=t)-1]=[]);var c={id:"test",content:e,amISender:!0,time:a||new Date,status:"sent"};r[n-1].push(c),this.setState(r),t||this.setLastMessage(),localStorage.setItem("messages",JSON.stringify(r))}},{key:"createHandler",value:function(){var e=this.state,a=e.chats,t=e.chatCounter,s=prompt("Enter person's name"),n=prompt("Write a message");t+=1,this.messageHandler(n,new Date,t);var r=this.state.messages[t-1];a.push({id:t,title:s,is_group:!1,host:"Vladimir Carpa",lastMessage:r[r.length-1]}),this.setState({chats:a,chatCounter:t}),this.setLastMessage(t),localStorage.setItem("chats",JSON.stringify(a)),localStorage.setItem("chatCounter",JSON.stringify(t))}},{key:"setLastMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this.state,t=a.messages,s=a.chats,n=this.state.currentDialogue;e&&(n=e);var r=t[n-1];s[n-1].lastMessage=r[r.length-1],this.setState(s),localStorage.setItem("chats",JSON.stringify(s))}},{key:"render",value:function(){var e=this.state;return n.a.createElement(f.Provider,{value:this},n.a.createElement("div",{className:J.a.container},n.a.createElement(B,{chats:e.chats}),n.a.createElement(L,{style:e.MessageFormAppearance,details:e.currentDialogue&&e.chats[e.currentDialogue-1],messages:e.currentDialogue&&e.messages[e.currentDialogue-1]})))}}]),a}(n.a.Component);Object(r.render)(n.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}],[[17,1,2]]]);
//# sourceMappingURL=main.599014d1.chunk.js.map